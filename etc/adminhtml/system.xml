<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd">
    <system>
        <section id="tax">
            <!-- TODO: Figure out how to make sure AvaTax module is handling translation of this/these group[s] and down. -->
            <group id="avatax" translate="label" sortOrder="6" showInDefault="1" showInWebsite="1" showInStore="1">
                <label>AvaTax Settings</label>
                <field id="enabled" translate="label" type="select" sortOrder="1000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Enable AvaTax</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                </field>
                <field id="connection_settings_header" translate="label" type="label" sortOrder="1010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Connection Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <!-- TODO: Consider using the term "test" for non production/live environments instead of "development". -->
                <field id="live_mode" translate="label" type="select" sortOrder="1020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Mode</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\Mode</source_model>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="production_account_number" translate="label" type="text" sortOrder="1030" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Account Number (Production)</label>
                    <frontend_class>required-entry</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="live_mode">1</field>
                    </depends>
                </field>
                <!-- TODO: Change this to a password? -->
                <field id="production_license_key" translate="label" type="text" sortOrder="1040" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>License Key (Production)</label>
                    <frontend_class>required-entry</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="live_mode">1</field>
                    </depends>
                </field>
                <field id="production_company_code" translate="label" type="text" sortOrder="1050" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Company Code (Production)</label>
                    <frontend_class>required-entry validate-length maximum-length-25</frontend_class>
                    <depends>
                        <field id="live_mode">1</field>
                    </depends>
                </field>
                <!-- TODO: Have an error if development or production credentials are not entered on config after save -->
                <field id="development_account_number" translate="label" type="text" sortOrder="1060" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Account Number (Development)</label>
                    <frontend_class>required-entry</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="live_mode">0</field>
                    </depends>
                </field>
                <!-- TODO: Change this to a password? -->
                <field id="development_license_key" translate="label" type="text" sortOrder="1070" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>License Key (Development)</label>
                    <frontend_class>required-entry</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="live_mode">0</field>
                    </depends>
                </field>
                <field id="development_company_code" translate="label" type="text" sortOrder="1080" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Company Code (Development)</label>
                    <frontend_class>required-entry validate-length maximum-length-25</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="live_mode">0</field>
                    </depends>
                </field>
                <field id="logging_settings_header" translate="label" type="label" sortOrder="1500" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Logging Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="logging_db_level" translate="label" type="select" sortOrder="1510" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Database Log Level</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\LogLevel</source_model>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                    <comment>Notice or Warning recommended for production use</comment>
                </field>
                <field id="logging_db_detail" translate="label" type="select" sortOrder="1520" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Database Log Detail</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\LogDetail</source_model>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                    <comment>Minimal recommended for production use</comment>
                </field>
                <field id="logging_db_lifetime" translate="label" type="text" sortOrder="1530" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Database Log Record Lifetime, Days</label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="logging_file_enabled" translate="label" type="select" sortOrder="1540" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Enable Logging To File</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                    <comment>Archiving of log files is affected by System -> Admin Actions Log Archiving</comment>
                </field>
                <field id="logging_file_mode" translate="label" type="select" sortOrder="1550" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>File Log Mode</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\LogFileMode</source_model>
                    <depends>
                        <field id="logging_file_enabled">1</field>
                    </depends>
                    <comment>Log files are located in the magento var/log/ directory</comment>
                </field>
                <field id="logging_file_level" translate="label" type="select" sortOrder="1560" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>File Log Level</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\LogLevel</source_model>
                    <depends>
                        <field id="logging_file_enabled">1</field>
                    </depends>
                    <comment>Info or Notice recommended for production use</comment>
                </field>
                <field id="logging_file_detail" translate="label" type="select" sortOrder="1570" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>File Log Detail</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\LogDetail</source_model>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                    <comment>Normal recommended for production use</comment>
                </field>
                <field id="data_mapping_header" translate="label" type="label" sortOrder="2000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Data Mapping</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <!-- TODO: Possibly have a value that gets set after the first time a live mode customer is set and disable the ability to change this value -->
                <field id="customer_code_format" translate="label comment" type="select" sortOrder="2010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Customer Code Format</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\CustomerCode</source_model>
                    <comment>Select a format for customers to be identified in AvaTax.  Once the integration is live, this setting should not be changed.</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_shipping" translate="label" type="text" sortOrder="2020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Shipping SKU</label>
                    <comment>The SKU sent to denote shipping costs.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_gift_wrap_order" translate="label" type="text" sortOrder="2030" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Gift Wrap Order SKU</label>
                    <comment>The SKU sent AvaTax to denote gift wrap order costs.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_gift_wrap_item" translate="label" type="text" sortOrder="2040" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Gift Wrap Items SKU</label>
                    <comment>The SKU sent AvaTax to denote gift wrap item costs.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_gift_wrap_card" translate="label" type="text" sortOrder="2050" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Gift Wrap Printed Card SKU</label>
                    <comment>The SKU sent to denote gift wrap printed card costs.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_adjustment_positive" translate="label" type="text" sortOrder="2060" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Adjustment Refund Sku</label>
                    <comment>The SKU sent to denote positive ajustments.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="sku_adjustment_negative" translate="label" type="text" sortOrder="2070" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Adjustment Refund SKU</label>
                    <comment>The SKU sent to denote negative ajustments.</comment>
                    <frontend_class>required-entry validate-length maximum-length-50</frontend_class>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="location_code" translate="label" type="text" sortOrder="2080" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Location Code</label>
                    <comment>Optional, unless outlet-based reporting is needed. Location code is a value assigned by some State jurisdictions that identifies a particular store location. These States may require tax liabilities to be broken out separately for each store Location.</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="ref1" translate="label comment" type="select" sortOrder="2090" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Attribute to send as ref1</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\Product\Attributes</source_model>
                    <comment>Select a text type product attribute to be sent to AvaTax as ref1. Only the first 250 characters of this attribute will be sent to AvaTax.</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="ref2" translate="label comment" type="select" sortOrder="2100" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Attribute to send as ref2</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\Product\Attributes</source_model>
                    <comment>Select a text type product attribute to be sent to AvaTax as ref1. Only the first 250 characters of this attribute will be sent to AvaTax.</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="general_header" translate="label" type="label" sortOrder="3000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>General Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="use_business_identification_number" translate="label comment" type="select" sortOrder="3010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Submit VAT Number to AvaTax</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>Set this to yes if you need to consider VAT when calculating tax</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="business_identification_number" translate="label comment" type="text" sortOrder="3020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>VAT Number</label>
                    <config_path>tax/avatax/business_identification_number</config_path>
                    <comment>VAT Number can also be found at GENERAL: General -> Store Information -> VAT Number</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="use_business_identification_number">1</field>
                    </depends>
                </field>
                <field id="address_validation_header" translate="label" type="label" sortOrder="4000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Address Validation Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="address_validation_enabled" translate="label comment" type="select" sortOrder="4010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Enable Address Validation</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <config_path>tax/avatax/address_validation_enabled</config_path>
                    <comment>Enable validation of shipping address using the AvaTax Address Validation API</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="address_validation_user_has_choice" translate="label comment" type="select" sortOrder="4020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Allow user to choose original (invalid) address</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>Set this to "Yes" to allow the user to choose between the the original and validated addresses (valid address will be selected by default). If set to "No", user will be required to use validated address or update their original address.</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="address_validation">1</field>
                    </depends>
                </field>
                <field id="address_validation_countries_enabled" translate="label comment" type="multiselect" sortOrder="4030" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Enabled Countries</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\AddressValidationCountries</source_model>
                    <comment>Select which countries to enable for address validation. AvaTax Address Validation currently only supports United States and Canada.</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="address_validation">1</field>
                    </depends>
                </field>
                <field id="address_validation_instructions_with_choice" translate="label comment" type="textarea" sortOrder="4040" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Address Validation Instructions With Choice</label>
                    <comment>This text will be displayed to the user in the "Verify Your Address" step of the checkout process when the "Allow user to choose original (invalid) address" option above is set to "Yes"</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="address_validation">1</field>
                        <field id="address_validation_user_has_choice">1</field>
                    </depends>
                </field>
                <field id="address_validation_instructions_without_choice" translate="label comment" type="textarea" sortOrder="4050" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Address Validation Instructions Without Choice</label>
                    <comment>This text will be displayed to the user in the "Verify Your Address" step of the checkout process when the "Allow user to choose original (invalid) address" option above is set to "No"</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="address_validation">1</field>
                        <field id="address_validation_user_has_choice">0</field>
                    </depends>
                </field>
                <field id="address_validation_error_instructions" translate="label comment" type="textarea" sortOrder="4060" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Address Validation Error Instructions</label>
                    <comment>This text will be displayed to the user in the "Verify Your Address" step of the checkout process when there is an error in the validation process</comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="address_validation">1</field>
                    </depends>
                </field>
                <field id="error_handling_header" translate="label" type="label" sortOrder="5000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Error Handling Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="error_action" translate="label comment" type="select" sortOrder="5010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Error Action</label>
                    <source_model>ClassyLlama\AvaTax\Model\Config\Source\ErrorAction</source_model>
                    <comment><![CDATA[What should happen if Magento is unable to retrieve taxes from the AvaTax API. Regardless of which option is selected, if there is an error in the AvaTax tax calculation, the extension will fall back to using native Magento tax rules. However if <strong>Disable checkout & show error message</strong> is selected, the extension will prevent users and admins from placing orders.]]></comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="error_action_disable_checkout_message_frontend" translate="label comment" type="textarea" sortOrder="5020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Frontend Error Message</label>
                    <comment><![CDATA[This error message will be displayed to user if there is an error calculating taxes and if <strong>Disable checkout & show error message</strong> is selected above.]]></comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="error_action">1</field>
                    </depends>
                </field>
                <field id="error_action_disable_checkout_message_backend" translate="label comment" type="textarea" sortOrder="5030" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Backend Error Message</label>
                    <comment><![CDATA[This error message will be displayed to admin if there is an error calculating taxes and if <strong>Disable checkout & show error message</strong> is selected above.]]></comment>
                    <depends>
                        <field id="enabled">1</field>
                        <field id="error_action">1</field>
                    </depends>
                </field>
                <field id="queue_processing_header" translate="label" type="label" sortOrder="6000" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label><![CDATA[<strong>Queue Processing Settings</strong>]]></label>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="queue_submission_enabled" translate="label" type="select" sortOrder="6010" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Submit Orders to AvaTax</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>This will enable queueing of Invoices and Credit Memos to be submitted to AvaTax on a schedule via a cron job</comment>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
                <field id="queue_max_retry_attempts" translate="label comment" type="text" sortOrder="6020" showInDefault="1" showInWebsite="1" showInStore="1">
                    <label>Max Queue Retry Attempts</label>
                    <comment>Please enter a number 1 or greater in this field.</comment>
                    <frontend_class>validate-number</frontend_class>
                    <validate>required-entry integer validate-greater-than-zero</validate>
                    <depends>
                        <field id="enabled">1</field>
                    </depends>
                </field>
            </group>
        </section>
    </system>
</config>
